import{Vector4 as e,Vector3 as t,Vector2 as r,MathUtils as i,BufferGeometry as n,BufferAttribute as a,Points as o,PointsMaterial as s,Quaternion as u,Matrix4 as l,Mesh as c,BoxGeometry as p,AdditiveBlending as h,TextureLoader as d,LinearFilter as A,ClampToEdgeWrapping as g,ShaderMaterial as f,UniformsUtils as y,ShaderLib as m,Color as v}from"three";import x,{Color as w}from"soonspacejs";var C={vertexShader:"\n    varying vec3 vViewPosition;\n    varying vec3 vWorldPos;\n    varying vec3 vNormal;\n\n    #include <common>\n    #include <uv_pars_vertex>\n    #include <displacementmap_pars_vertex>\n    #include <envmap_pars_vertex>\n    #include <color_pars_vertex>\n    #include <morphtarget_pars_vertex>\n    #include <skinning_pars_vertex>\n    #include <shadowmap_pars_vertex>\n    #include <logdepthbuf_pars_vertex>\n    #include <clipping_planes_pars_vertex>\n \n    void main() {\n\n      #include <uv_vertex>\n      #include <color_vertex>\n \n      //# include <begin_vertex>\n      vec3 transformed = vec3( position.x, position.y, position.z );\n      //<begin_vertex>\n \n      #include <morphtarget_vertex>\n      #include <displacementmap_vertex>\n      #include <project_vertex>\n      #include <logdepthbuf_vertex>\n      #include <clipping_planes_vertex>\n\n      vViewPosition = - mvPosition.xyz;\n\n      #include <worldpos_vertex>\n\n      vWorldPos = (modelMatrix * vec4(position, 1.0)).xyz;\n    }",fragmentShader:"\n      #include <packing>\n      #include <logdepthbuf_pars_fragment>\n \n         uniform vec3 color;\n         uniform float time;\n         uniform float seed;\n         uniform mat4 invModelMatrix;\n         uniform vec3 scale;\n \n         uniform vec4 noiseScale;\n         uniform float magnitude;\n         uniform float lacunarity;\n         uniform float gain;\n \n         uniform sampler2D fireTex;\n \n         varying vec3 vWorldPos;\n \n         // GLSL simplex noise function by ashima / https://github.com/ashima/webgl-noise/blob/master/src/noise3D.glsl\n         // -------- simplex noise\n         vec3 mod289(vec3 x) {\n             return x - floor(x * (1.0 / 289.0)) * 289.0;\n         }\n \n         vec4 mod289(vec4 x) {\n             return x - floor(x * (1.0 / 289.0)) * 289.0;\n         }\n \n         vec4 permute(vec4 x) {\n             return mod289(((x * 34.0) + 1.0) * x);\n         }\n \n         vec4 taylorInvSqrt(vec4 r) {\n             return 1.79284291400159 - 0.85373472095314 * r;\n         }\n \n         float snoise(vec3 v) {\n             const vec2 C = vec2(1.0 / 6.0, 1.0 / 3.0);\n             const vec4 D = vec4(0.0, 0.5, 1.0, 2.0);\n \n             // First corner\n             vec3 i  = floor(v + dot(v, C.yyy));\n             vec3 x0 = v - i + dot(i, C.xxx);\n \n             // Other corners\n             vec3 g = step(x0.yzx, x0.xyz);\n             vec3 l = 1.0 - g;\n             vec3 i1 = min(g.xyz, l.zxy);\n             vec3 i2 = max(g.xyz, l.zxy);\n \n             //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n             //   x1 = x0 - i1  + 1.0 * C.xxx;\n             //   x2 = x0 - i2  + 2.0 * C.xxx;\n             //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n             vec3 x1 = x0 - i1 + C.xxx;\n             vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n             vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n \n             // Permutations\n             i = mod289(i); \n             vec4 p = permute(permute(permute( \n                     i.z + vec4(0.0, i1.z, i2.z, 1.0))\n                     + i.y + vec4(0.0, i1.y, i2.y, 1.0))\n                     + i.x + vec4(0.0, i1.x, i2.x, 1.0));\n \n             // Gradients: 7x7 points over a square, mapped onto an octahedron.\n             // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n             float n_ = 0.142857142857; // 1.0/7.0\n             vec3  ns = n_ * D.wyz - D.xzx;\n \n             vec4 j = p - 49.0 * floor(p * ns.z * ns.z); //  mod(p,7*7)\n \n             vec4 x_ = floor(j * ns.z);\n             vec4 y_ = floor(j - 7.0 * x_); // mod(j,N)\n \n             vec4 x = x_ * ns.x + ns.yyyy;\n             vec4 y = y_ * ns.x + ns.yyyy;\n             vec4 h = 1.0 - abs(x) - abs(y);\n \n             vec4 b0 = vec4(x.xy, y.xy);\n             vec4 b1 = vec4(x.zw, y.zw);\n \n             //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n             //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n             vec4 s0 = floor(b0) * 2.0 + 1.0;\n             vec4 s1 = floor(b1) * 2.0 + 1.0;\n             vec4 sh = -step(h, vec4(0.0));\n \n             vec4 a0 = b0.xzyw + s0.xzyw * sh.xxyy;\n             vec4 a1 = b1.xzyw + s1.xzyw * sh.zzww;\n \n             vec3 p0 = vec3(a0.xy, h.x);\n             vec3 p1 = vec3(a0.zw, h.y);\n             vec3 p2 = vec3(a1.xy, h.z);\n             vec3 p3 = vec3(a1.zw, h.w);\n \n             //Normalise gradients\n             vec4 norm = taylorInvSqrt(vec4(dot(p0, p0), dot(p1, p1), dot(p2, p2), dot(p3, p3)));\n             p0 *= norm.x;\n             p1 *= norm.y;\n             p2 *= norm.z;\n             p3 *= norm.w;\n \n             // Mix final noise value\n             vec4 m = max(0.6 - vec4(dot(x0, x0), dot(x1, x1), dot(x2, x2), dot(x3, x3)), 0.0);\n             m = m * m;\n             return 42.0 * dot(m * m, vec4(dot(p0, x0), dot(p1, x1), dot(p2, x2), dot(p3, x3)));\n         }\n         // simplex noise --------\n \n         float turbulence(vec3 p) {\n             float sum = 0.0;\n             float freq = 1.0;\n             float amp = 1.0;\n             \n             for(int i = 0; i < OCTIVES; i++) {\n                 sum += abs(snoise(p * freq)) * amp;\n                 freq *= lacunarity;\n                 amp *= gain;\n             }\n \n             return sum;\n         }\n \n         vec4 samplerFire (vec3 p, vec4 scale) {\n             vec2 st = vec2(sqrt(dot(p.xz, p.xz)), p.y);\n \n             if(st.x <= 0.0 || st.x >= 1.0 || st.y <= 0.0 || st.y >= 1.0) return vec4(0.0);\n \n             p.y -= (seed + time) * scale.w;\n             p *= scale.xyz;\n \n             st.y += sqrt(st.y) * magnitude * turbulence(p);\n \n             if(st.y <= 0.0 || st.y >= 1.0) return vec4(0.0);\n            \n             return texture2D(fireTex, st);\n         }\n \n         vec3 localize(vec3 p) {\n             return (invModelMatrix * vec4(p, 1.0)).xyz;\n         }\n \n         void main() {\n           #include <logdepthbuf_fragment>\n \n             vec3 rayPos = vWorldPos;\n             vec3 rayDir = normalize(rayPos - cameraPosition);\n             float rayLen = 0.0288 * length(scale.xyz);\n \n             vec4 col = vec4(0.0);\n \n             for(int i = 0; i < ITERATIONS; i++) {\n                 rayPos += rayDir * rayLen;\n \n                 vec3 lp = localize(rayPos);\n \n                 lp.y += 0.5;\n                 lp.xz *= 2.0;\n                 col += samplerFire(lp, noiseScale);\n             }\n \n             col.a = col.r;\n             gl_FragColor.a = 1.0;\n             gl_FragColor = col;\n         }"},E="data:image/png;base64,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";const{THREE:b}=x;var B,D,M={distributions:{BOX:1,SPHERE:2,DISC:3,LINE:4},valueOverLifetimeLength:4};M.TypedArrayHelper=function(e,t,r,i){this.componentSize=r||1,this.size=t||1,this.TypedArrayConstructor=e||Float32Array,this.array=new e(t*this.componentSize),this.indexOffset=i||0},M.TypedArrayHelper.constructor=M.TypedArrayHelper,M.TypedArrayHelper.prototype.setSize=function(e,t){var r=this.array.length;return t||(e*=this.componentSize),e<r?this.shrink(e):e>r?this.grow(e):void console.info("TypedArray is already of size:",e+".","Will not resize.")},M.TypedArrayHelper.prototype.shrink=function(e){return this.array=this.array.subarray(0,e),this.size=e,this},M.TypedArrayHelper.prototype.grow=function(e){var t=this.array,r=new this.TypedArrayConstructor(e);return r.set(t),this.array=r,this.size=e,this},M.TypedArrayHelper.prototype.splice=function(e,t){e*=this.componentSize,t*=this.componentSize;for(var r=[],i=this.array,n=i.length,a=0;a<n;++a)(a<e||a>=t)&&r.push(i[a]);return this.setFromArray(0,r),this},M.TypedArrayHelper.prototype.setFromArray=function(e,t){var r=e+t.length;return r>this.array.length?this.grow(r):r<this.array.length&&this.shrink(r),this.array.set(t,this.indexOffset+e),this},M.TypedArrayHelper.prototype.setVec2=function(e,t){return this.setVec2Components(e,t.x,t.y)},M.TypedArrayHelper.prototype.setVec2Components=function(e,t,r){var i=this.array,n=this.indexOffset+e*this.componentSize;return i[n]=t,i[n+1]=r,this},M.TypedArrayHelper.prototype.setVec3=function(e,t){return this.setVec3Components(e,t.x,t.y,t.z)},M.TypedArrayHelper.prototype.setVec3Components=function(e,t,r,i){var n=this.array,a=this.indexOffset+e*this.componentSize;return n[a]=t,n[a+1]=r,n[a+2]=i,this},M.TypedArrayHelper.prototype.setVec4=function(e,t){return this.setVec4Components(e,t.x,t.y,t.z,t.w)},M.TypedArrayHelper.prototype.setVec4Components=function(e,t,r,i,n){var a=this.array,o=this.indexOffset+e*this.componentSize;return a[o]=t,a[o+1]=r,a[o+2]=i,a[o+3]=n,this},M.TypedArrayHelper.prototype.setMat3=function(e,t){return this.setFromArray(this.indexOffset+e*this.componentSize,t.elements)},M.TypedArrayHelper.prototype.setMat4=function(e,t){return this.setFromArray(this.indexOffset+e*this.componentSize,t.elements)},M.TypedArrayHelper.prototype.setColor=function(e,t){return this.setVec3Components(e,t.r,t.g,t.b)},M.TypedArrayHelper.prototype.setNumber=function(e,t){return this.array[this.indexOffset+e*this.componentSize]=t,this},M.TypedArrayHelper.prototype.getValueAtIndex=function(e){return this.array[this.indexOffset+e]},M.TypedArrayHelper.prototype.getComponentValueAtIndex=function(e){return this.array.subarray(this.indexOffset+e*this.componentSize)},M.ShaderAttribute=function(e,t,r){var i=M.ShaderAttribute.typeSizeMap;this.type="string"==typeof e&&i.hasOwnProperty(e)?e:"f",this.componentSize=i[this.type],this.arrayType=r||Float32Array,this.typedArray=null,this.bufferAttribute=null,this.dynamicBuffer=!!t,this.updateMin=0,this.updateMax=0},M.ShaderAttribute.constructor=M.ShaderAttribute,M.ShaderAttribute.typeSizeMap={f:1,v2:2,v3:3,v4:4,c:3,m3:9,m4:16},M.ShaderAttribute.prototype.setUpdateRange=function(e,t){this.updateMin=Math.min(e*this.componentSize,this.updateMin*this.componentSize),this.updateMax=Math.max(t*this.componentSize,this.updateMax*this.componentSize)},M.ShaderAttribute.prototype.flagUpdate=function(){var e=this.bufferAttribute,t=e.updateRange;t.offset=this.updateMin,t.count=Math.min(this.updateMax-this.updateMin+this.componentSize,this.typedArray.array.length),e.needsUpdate=!0},M.ShaderAttribute.prototype.resetUpdateRange=function(){this.updateMin=0,this.updateMax=0},M.ShaderAttribute.prototype.resetDynamic=function(){this.bufferAttribute.usage=this.dynamicBuffer?b.DynamicDrawUsage:b.StaticDrawUsage},M.ShaderAttribute.prototype.splice=function(e,t){this.typedArray.splice(e,t),this.forceUpdateAll()},M.ShaderAttribute.prototype.forceUpdateAll=function(){this.bufferAttribute.array=this.typedArray.array,this.bufferAttribute.updateRange.offset=0,this.bufferAttribute.updateRange.count=-1,this.bufferAttribute.usage=b.StaticDrawUsage,this.bufferAttribute.needsUpdate=!0},M.ShaderAttribute.prototype._ensureTypedArray=function(e){null!==this.typedArray&&this.typedArray.size===e*this.componentSize||(null!==this.typedArray&&this.typedArray.size!==e?this.typedArray.setSize(e):null===this.typedArray&&(this.typedArray=new M.TypedArrayHelper(this.arrayType,e,this.componentSize)))},M.ShaderAttribute.prototype._createBufferAttribute=function(e){if(this._ensureTypedArray(e),null!==this.bufferAttribute)return this.bufferAttribute.array=this.typedArray.array,parseFloat(b.REVISION)>=81&&(this.bufferAttribute.count=this.bufferAttribute.array.length/this.bufferAttribute.itemSize),void(this.bufferAttribute.needsUpdate=!0);this.bufferAttribute=new b.BufferAttribute(this.typedArray.array,this.componentSize),this.bufferAttribute.usage=this.dynamicBuffer?b.DynamicDrawUsage:b.StaticDrawUsage},M.ShaderAttribute.prototype.getLength=function(){return null===this.typedArray?0:this.typedArray.array.length},M.shaderChunks={defines:["#define PACKED_COLOR_SIZE 256.0","#define PACKED_COLOR_DIVISOR 255.0"].join("\n"),uniforms:["uniform float deltaTime;","uniform float runTime;","uniform sampler2D tex;","uniform vec4 textureAnimation;","uniform float scale;"].join("\n"),attributes:["attribute vec4 acceleration;","attribute vec3 velocity;","attribute vec4 rotation;","attribute vec3 rotationCenter;","attribute vec4 params;","attribute vec4 size;","attribute vec4 angle;","attribute vec4 color;","attribute vec4 opacity;"].join("\n"),varyings:["varying vec4 vColor;","#ifdef SHOULD_ROTATE_TEXTURE","    varying float vAngle;","#endif","#ifdef SHOULD_CALCULATE_SPRITE","    varying vec4 vSpriteSheet;","#endif"].join("\n"),branchAvoidanceFunctions:["float when_gt(float x, float y) {","    return max(sign(x - y), 0.0);","}","float when_lt(float x, float y) {","    return min( max(1.0 - sign(x - y), 0.0), 1.0 );","}","float when_eq( float x, float y ) {","    return 1.0 - abs( sign( x - y ) );","}","float when_ge(float x, float y) {","  return 1.0 - when_lt(x, y);","}","float when_le(float x, float y) {","  return 1.0 - when_gt(x, y);","}","float and(float a, float b) {","    return a * b;","}","float or(float a, float b) {","    return min(a + b, 1.0);","}"].join("\n"),unpackColor:["vec3 unpackColor( in float hex ) {","   vec3 c = vec3( 0.0 );","   float r = mod( (hex / PACKED_COLOR_SIZE / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE );","   float g = mod( (hex / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE );","   float b = mod( hex, PACKED_COLOR_SIZE );","   c.r = r / PACKED_COLOR_DIVISOR;","   c.g = g / PACKED_COLOR_DIVISOR;","   c.b = b / PACKED_COLOR_DIVISOR;","   return c;","}"].join("\n"),unpackRotationAxis:["vec3 unpackRotationAxis( in float hex ) {","   vec3 c = vec3( 0.0 );","   float r = mod( (hex / PACKED_COLOR_SIZE / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE );","   float g = mod( (hex / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE );","   float b = mod( hex, PACKED_COLOR_SIZE );","   c.r = r / PACKED_COLOR_DIVISOR;","   c.g = g / PACKED_COLOR_DIVISOR;","   c.b = b / PACKED_COLOR_DIVISOR;","   c *= vec3( 2.0 );","   c -= vec3( 1.0 );","   return c;","}"].join("\n"),floatOverLifetime:["float getFloatOverLifetime( in float positionInTime, in vec4 attr ) {","    highp float value = 0.0;","    float deltaAge = positionInTime * float( VALUE_OVER_LIFETIME_LENGTH - 1 );","    float fIndex = 0.0;","    float shouldApplyValue = 0.0;","    value += attr[ 0 ] * when_eq( deltaAge, 0.0 );","","    for( int i = 0; i < VALUE_OVER_LIFETIME_LENGTH - 1; ++i ) {","       fIndex = float( i );","       shouldApplyValue = and( when_gt( deltaAge, fIndex ), when_le( deltaAge, fIndex + 1.0 ) );","       value += shouldApplyValue * mix( attr[ i ], attr[ i + 1 ], deltaAge - fIndex );","    }","","    return value;","}"].join("\n"),colorOverLifetime:["vec3 getColorOverLifetime( in float positionInTime, in vec3 color1, in vec3 color2, in vec3 color3, in vec3 color4 ) {","    vec3 value = vec3( 0.0 );","    value.x = getFloatOverLifetime( positionInTime, vec4( color1.x, color2.x, color3.x, color4.x ) );","    value.y = getFloatOverLifetime( positionInTime, vec4( color1.y, color2.y, color3.y, color4.y ) );","    value.z = getFloatOverLifetime( positionInTime, vec4( color1.z, color2.z, color3.z, color4.z ) );","    return value;","}"].join("\n"),paramFetchingFunctions:["float getAlive() {","   return params.x;","}","float getAge() {","   return params.y;","}","float getMaxAge() {","   return params.z;","}","float getWiggle() {","   return params.w;","}"].join("\n"),forceFetchingFunctions:["vec4 getPosition( in float age ) {","   return modelViewMatrix * vec4( position, 1.0 );","}","vec3 getVelocity( in float age ) {","   return velocity * age;","}","vec3 getAcceleration( in float age ) {","   return acceleration.xyz * age;","}"].join("\n"),rotationFunctions:["#ifdef SHOULD_ROTATE_PARTICLES","   mat4 getRotationMatrix( in vec3 axis, in float angle) {","       axis = normalize(axis);","       float s = sin(angle);","       float c = cos(angle);","       float oc = 1.0 - c;","","       return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,","                   oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,","                   oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,","                   0.0,                                0.0,                                0.0,                                1.0);","   }","","   vec3 getRotation( in vec3 pos, in float positionInTime ) {","      if( rotation.y == 0.0 ) {","           return pos;","      }","","      vec3 axis = unpackRotationAxis( rotation.x );","      vec3 center = rotationCenter;","      vec3 translated;","      mat4 rotationMatrix;","      float angle = 0.0;","      angle += when_eq( rotation.z, 0.0 ) * rotation.y;","      angle += when_gt( rotation.z, 0.0 ) * mix( 0.0, rotation.y, positionInTime );","      translated = rotationCenter - pos;","      rotationMatrix = getRotationMatrix( axis, angle );","      return center - vec3( rotationMatrix * vec4( translated, 0.0 ) );","   }","#endif"].join("\n"),rotateTexture:["    vec2 vUv = vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y );","","    #ifdef SHOULD_ROTATE_TEXTURE","       float x = gl_PointCoord.x - 0.5;","       float y = 1.0 - gl_PointCoord.y - 0.5;","       float c = cos( -vAngle );","       float s = sin( -vAngle );","       vUv = vec2( c * x + s * y + 0.5, c * y - s * x + 0.5 );","    #endif","","    #ifdef SHOULD_CALCULATE_SPRITE","        float framesX = vSpriteSheet.x;","        float framesY = vSpriteSheet.y;","        float columnNorm = vSpriteSheet.z;","        float rowNorm = vSpriteSheet.w;","        vUv.x = gl_PointCoord.x * framesX + columnNorm;","        vUv.y = 1.0 - (gl_PointCoord.y * framesY + rowNorm);","    #endif","","    vec4 rotatedTexture = texture2D( tex, vUv );"].join("\n")},M.shaders={vertex:[M.shaderChunks.defines,M.shaderChunks.uniforms,M.shaderChunks.attributes,M.shaderChunks.varyings,b.ShaderChunk.common,b.ShaderChunk.logdepthbuf_pars_vertex,b.ShaderChunk.fog_pars_vertex,M.shaderChunks.branchAvoidanceFunctions,M.shaderChunks.unpackColor,M.shaderChunks.unpackRotationAxis,M.shaderChunks.floatOverLifetime,M.shaderChunks.colorOverLifetime,M.shaderChunks.paramFetchingFunctions,M.shaderChunks.forceFetchingFunctions,M.shaderChunks.rotationFunctions,"void main() {","    highp float age = getAge();","    highp float alive = getAlive();","    highp float maxAge = getMaxAge();","    highp float positionInTime = (age / maxAge);","    highp float isAlive = when_gt( alive, 0.0 );","    #ifdef SHOULD_WIGGLE_PARTICLES","        float wiggleAmount = positionInTime * getWiggle();","        float wiggleSin = isAlive * sin( wiggleAmount );","        float wiggleCos = isAlive * cos( wiggleAmount );","    #endif","    vec3 vel = getVelocity( age );","    vec3 accel = getAcceleration( age );","    vec3 force = vec3( 0.0 );","    vec3 pos = vec3( position );","    float drag = 1.0 - (positionInTime * 0.5) * acceleration.w;","    force += vel;","    force *= drag;","    force += accel * age;","    pos += force;","    #ifdef SHOULD_WIGGLE_PARTICLES","        pos.x += wiggleSin;","        pos.y += wiggleCos;","        pos.z += wiggleSin;","    #endif","    #ifdef SHOULD_ROTATE_PARTICLES","        pos = getRotation( pos, positionInTime );","    #endif","    vec4 mvPosition = modelViewMatrix * vec4( pos, 1.0 );","    highp float pointSize = getFloatOverLifetime( positionInTime, size ) * isAlive;","    #ifdef HAS_PERSPECTIVE","        float perspective = scale / length( mvPosition.xyz );","    #else","        float perspective = 1.0;","    #endif","    float pointSizePerspective = pointSize * perspective;","    #ifdef COLORIZE","       vec3 c = isAlive * getColorOverLifetime(","           positionInTime,","           unpackColor( color.x ),","           unpackColor( color.y ),","           unpackColor( color.z ),","           unpackColor( color.w )","       );","    #else","       vec3 c = vec3(1.0);","    #endif","    float o = isAlive * getFloatOverLifetime( positionInTime, opacity );","    vColor = vec4( c, o );","    #ifdef SHOULD_ROTATE_TEXTURE","        vAngle = isAlive * getFloatOverLifetime( positionInTime, angle );","    #endif","    #ifdef SHOULD_CALCULATE_SPRITE","        float framesX = textureAnimation.x;","        float framesY = textureAnimation.y;","        float loopCount = textureAnimation.w;","        float totalFrames = textureAnimation.z;","        float frameNumber = mod( (positionInTime * loopCount) * totalFrames, totalFrames );","        float column = floor(mod( frameNumber, framesX ));","        float row = floor( (frameNumber - column) / framesX );","        float columnNorm = column / framesX;","        float rowNorm = row / framesY;","        vSpriteSheet.x = 1.0 / framesX;","        vSpriteSheet.y = 1.0 / framesY;","        vSpriteSheet.z = columnNorm;","        vSpriteSheet.w = rowNorm;","    #endif","    gl_PointSize = pointSizePerspective;","    gl_Position = projectionMatrix * mvPosition;",b.ShaderChunk.logdepthbuf_vertex,b.ShaderChunk.fog_vertex,"}"].join("\n"),fragment:[M.shaderChunks.uniforms,b.ShaderChunk.common,b.ShaderChunk.fog_pars_fragment,b.ShaderChunk.logdepthbuf_pars_fragment,M.shaderChunks.varyings,M.shaderChunks.branchAvoidanceFunctions,"void main() {","    vec3 outgoingLight = vColor.xyz;","    ","    #ifdef ALPHATEST","       if ( vColor.w < float(ALPHATEST) ) discard;","    #endif",M.shaderChunks.rotateTexture,b.ShaderChunk.logdepthbuf_fragment,"    outgoingLight = vColor.xyz * rotatedTexture.xyz;","    gl_FragColor = vec4( outgoingLight.xyz, rotatedTexture.w * vColor.w );",b.ShaderChunk.fog_fragment,"}"].join("\n")},M.utils={types:{BOOLEAN:"boolean",STRING:"string",NUMBER:"number",OBJECT:"object"},ensureTypedArg:function(e,t,r){return typeof e===t?e:r},ensureArrayTypedArg:function(e,t,r){if(Array.isArray(e)){for(var i=e.length-1;i>=0;--i)if(typeof e[i]!==t)return r;return e}return this.ensureTypedArg(e,t,r)},ensureInstanceOf:function(e,t,r){return void 0!==t&&e instanceof t?e:r},ensureArrayInstanceOf:function(e,t,r){if(Array.isArray(e)){for(var i=e.length-1;i>=0;--i)if(void 0!==t&&e[i]instanceof t==!1)return r;return e}return this.ensureInstanceOf(e,t,r)},ensureValueOverLifetimeCompliance:function(e,t,r){t=t||3,r=r||3,!1===Array.isArray(e._value)&&(e._value=[e._value]),!1===Array.isArray(e._spread)&&(e._spread=[e._spread]);var i=this.clamp(e._value.length,t,r),n=this.clamp(e._spread.length,t,r),a=Math.max(i,n);e._value.length!==a&&(e._value=this.interpolateArray(e._value,a)),e._spread.length!==a&&(e._spread=this.interpolateArray(e._spread,a))},interpolateArray:function(e,t){for(var r=e.length,i=["function"==typeof e[0].clone?e[0].clone():e[0]],n=(r-1)/(t-1),a=1;a<t-1;++a){var o=a*n,s=Math.floor(o),u=Math.ceil(o),l=o-s;i[a]=this.lerpTypeAgnostic(e[s],e[u],l)}return i.push("function"==typeof e[r-1].clone?e[r-1].clone():e[r-1]),i},clamp:function(e,t,r){return Math.max(t,Math.min(e,r))},zeroToEpsilon:function(e,t){var r=1e-5,i=e;return i=t?Math.random()*r*10:r,e<0&&e>-1e-5&&(i=-i),i},lerpTypeAgnostic:function(e,t,r){var i,n=this.types;return typeof e===n.NUMBER&&typeof t===n.NUMBER?e+(t-e)*r:e instanceof b.Vector2&&t instanceof b.Vector2?((i=e.clone()).x=this.lerp(e.x,t.x,r),i.y=this.lerp(e.y,t.y,r),i):e instanceof b.Vector3&&t instanceof b.Vector3?((i=e.clone()).x=this.lerp(e.x,t.x,r),i.y=this.lerp(e.y,t.y,r),i.z=this.lerp(e.z,t.z,r),i):e instanceof b.Vector4&&t instanceof b.Vector4?((i=e.clone()).x=this.lerp(e.x,t.x,r),i.y=this.lerp(e.y,t.y,r),i.z=this.lerp(e.z,t.z,r),i.w=this.lerp(e.w,t.w,r),i):e instanceof b.Color&&t instanceof b.Color?((i=e.clone()).r=this.lerp(e.r,t.r,r),i.g=this.lerp(e.g,t.g,r),i.b=this.lerp(e.b,t.b,r),i):void console.warn("Invalid argument types, or argument types do not match:",e,t)},lerp:function(e,t,r){return e+(t-e)*r},roundToNearestMultiple:function(e,t){var r;return 0===t||0===(r=Math.abs(e)%t)?e:e<0?-(Math.abs(e)-r):e+t-r},arrayValuesAreEqual:function(e){for(var t=0;t<e.length-1;++t)if(e[t]!==e[t+1])return!1;return!0},randomFloat:function(e,t){return e+t*(Math.random()-.5)},randomVector3:function(e,t,r,i,n){var a=r.x+(Math.random()*i.x-.5*i.x),o=r.y+(Math.random()*i.y-.5*i.y),s=r.z+(Math.random()*i.z-.5*i.z);n&&(a=.5*-n.x+this.roundToNearestMultiple(a,n.x),o=.5*-n.y+this.roundToNearestMultiple(o,n.y),s=.5*-n.z+this.roundToNearestMultiple(s,n.z)),e.typedArray.setVec3Components(t,a,o,s)},randomColor:function(e,t,r,i){var n=r.r+Math.random()*i.x,a=r.g+Math.random()*i.y,o=r.b+Math.random()*i.z;n=this.clamp(n,0,1),a=this.clamp(a,0,1),o=this.clamp(o,0,1),e.typedArray.setVec3Components(t,n,a,o)},randomColorAsHex:(D=new b.Color,function(e,t,r,i){for(var n=r.length,a=[],o=0;o<n;++o){var s=i[o];D.copy(r[o]),D.r+=Math.random()*s.x-.5*s.x,D.g+=Math.random()*s.y-.5*s.y,D.b+=Math.random()*s.z-.5*s.z,D.r=this.clamp(D.r,0,1),D.g=this.clamp(D.g,0,1),D.b=this.clamp(D.b,0,1),a.push(D.getHex())}e.typedArray.setVec4Components(t,a[0],a[1],a[2],a[3])}),randomVector3OnLine:function(e,t,r,i){var n=r.clone();n.lerp(i,Math.random()),e.typedArray.setVec3Components(t,n.x,n.y,n.z)},randomVector3OnSphere:function(e,t,r,i,n,a,o,s){var u=2*Math.random()-1,l=6.2832*Math.random(),c=Math.sqrt(1-u*u),p=this.randomFloat(i,n),h=0,d=0,A=0;o&&(p=Math.round(p/o)*o),h=c*Math.cos(l)*p,d=c*Math.sin(l)*p,A=u*p,h*=a.x,d*=a.y,A*=a.z,h+=r.x,d+=r.y,A+=r.z,e.typedArray.setVec3Components(t,h,d,A)},seededRandom:function(e){var t=1e4*Math.sin(e);return t-(0|t)},randomVector3OnDisc:function(e,t,r,i,n,a,o){var s=6.2832*Math.random(),u=Math.abs(this.randomFloat(i,n)),l=0,c=0,p=0;o&&(u=Math.round(u/o)*o),l=Math.cos(s)*u,c=Math.sin(s)*u,l*=a.x,c*=a.y,l+=r.x,c+=r.y,p+=r.z,e.typedArray.setVec3Components(t,l,c,p)},randomDirectionVector3OnSphere:(B=new b.Vector3,function(e,t,r,i,n,a,o,s){B.copy(a),B.x-=r,B.y-=i,B.z-=n,B.normalize().multiplyScalar(-this.randomFloat(o,s)),e.typedArray.setVec3Components(t,B.x,B.y,B.z)}),randomDirectionVector3OnDisc:function(){var e=new b.Vector3;return function(t,r,i,n,a,o,s,u){e.copy(o),e.x-=i,e.y-=n,e.z-=a,e.normalize().multiplyScalar(-this.randomFloat(s,u)),t.typedArray.setVec3Components(r,e.x,e.y,0)}}(),getPackedRotationAxis:function(){var e=new b.Vector3,t=new b.Vector3,r=new b.Color,i=new b.Vector3(1,1,1);return function(n,a){return e.copy(n).normalize(),t.copy(a).normalize(),e.x+=.5*-a.x+Math.random()*a.x,e.y+=.5*-a.y+Math.random()*a.y,e.z+=.5*-a.z+Math.random()*a.z,e.normalize().add(i).multiplyScalar(.5),r.setRGB(e.x,e.y,e.z),r.getHex()}}()},M.Group=function(e){var t=M.utils,r=t.types;(e=t.ensureTypedArg(e,r.OBJECT,{})).texture=t.ensureTypedArg(e.texture,r.OBJECT,{}),this.uuid=b.MathUtils.generateUUID(),this.fixedTimeStep=t.ensureTypedArg(e.fixedTimeStep,r.NUMBER,.016),this.texture=t.ensureInstanceOf(e.texture.value,b.Texture,null),this.textureFrames=t.ensureInstanceOf(e.texture.frames,b.Vector2,new b.Vector2(1,1)),this.textureFrameCount=t.ensureTypedArg(e.texture.frameCount,r.NUMBER,this.textureFrames.x*this.textureFrames.y),this.textureLoop=t.ensureTypedArg(e.texture.loop,r.NUMBER,1),this.textureFrames.max(new b.Vector2(1,1)),this.hasPerspective=t.ensureTypedArg(e.hasPerspective,r.BOOLEAN,!0),this.colorize=t.ensureTypedArg(e.colorize,r.BOOLEAN,!0),this.maxParticleCount=t.ensureTypedArg(e.maxParticleCount,r.NUMBER,null),this.blending=t.ensureTypedArg(e.blending,r.NUMBER,b.AdditiveBlending),this.transparent=t.ensureTypedArg(e.transparent,r.BOOLEAN,!0),this.alphaTest=parseFloat(t.ensureTypedArg(e.alphaTest,r.NUMBER,0)),this.depthWrite=t.ensureTypedArg(e.depthWrite,r.BOOLEAN,!1),this.depthTest=t.ensureTypedArg(e.depthTest,r.BOOLEAN,!0),this.fog=t.ensureTypedArg(e.fog,r.BOOLEAN,!0),this.scale=t.ensureTypedArg(e.scale,r.NUMBER,300),this.emitters=[],this.emitterIDs=[],this._pool=[],this._poolCreationSettings=null,this._createNewWhenPoolEmpty=0,this._attributesNeedRefresh=!1,this._attributesNeedDynamicReset=!1,this.particleCount=0,this.uniforms={tex:{type:"t",value:this.texture},textureAnimation:{type:"v4",value:new b.Vector4(this.textureFrames.x,this.textureFrames.y,this.textureFrameCount,Math.max(Math.abs(this.textureLoop),1))},fogColor:{type:"c",value:this.fog?new b.Color:null},fogNear:{type:"f",value:10},fogFar:{type:"f",value:200},fogDensity:{type:"f",value:.5},deltaTime:{type:"f",value:0},runTime:{type:"f",value:0},scale:{type:"f",value:this.scale}},this.defines={HAS_PERSPECTIVE:this.hasPerspective,COLORIZE:this.colorize,VALUE_OVER_LIFETIME_LENGTH:M.valueOverLifetimeLength,SHOULD_ROTATE_TEXTURE:!1,SHOULD_ROTATE_PARTICLES:!1,SHOULD_WIGGLE_PARTICLES:!1,SHOULD_CALCULATE_SPRITE:this.textureFrames.x>1||this.textureFrames.y>1},this.attributes={position:new M.ShaderAttribute("v3",!0),acceleration:new M.ShaderAttribute("v4",!0),velocity:new M.ShaderAttribute("v3",!0),rotation:new M.ShaderAttribute("v4",!0),rotationCenter:new M.ShaderAttribute("v3",!0),params:new M.ShaderAttribute("v4",!0),size:new M.ShaderAttribute("v4",!0),angle:new M.ShaderAttribute("v4",!0),color:new M.ShaderAttribute("v4",!0),opacity:new M.ShaderAttribute("v4",!0)},this.attributeKeys=Object.keys(this.attributes),this.attributeCount=this.attributeKeys.length,this.material=new b.ShaderMaterial({uniforms:this.uniforms,vertexShader:M.shaders.vertex,fragmentShader:M.shaders.fragment,blending:this.blending,transparent:this.transparent,alphaTest:this.alphaTest,depthWrite:this.depthWrite,depthTest:this.depthTest,defines:this.defines,fog:this.fog}),this.geometry=new b.BufferGeometry,this.mesh=new b.Points(this.geometry,this.material),null===this.maxParticleCount&&console.warn("SPE.Group: No maxParticleCount specified. Adding emitters after rendering will probably cause errors.")},M.Group.constructor=M.Group,M.Group.prototype._updateDefines=function(){for(var e,t=this.emitters,r=t.length-1,i=this.defines;r>=0;--r)e=t[r],i.SHOULD_CALCULATE_SPRITE||(i.SHOULD_ROTATE_TEXTURE=i.SHOULD_ROTATE_TEXTURE||!!Math.max(Math.max.apply(null,e.angle.value),Math.max.apply(null,e.angle.spread))),i.SHOULD_ROTATE_PARTICLES=i.SHOULD_ROTATE_PARTICLES||!!Math.max(e.rotation.angle,e.rotation.angleSpread),i.SHOULD_WIGGLE_PARTICLES=i.SHOULD_WIGGLE_PARTICLES||!!Math.max(e.wiggle.value,e.wiggle.spread);this.material.needsUpdate=!0},M.Group.prototype._applyAttributesToGeometry=function(){var e,t,r=this.attributes,i=this.geometry,n=i.attributes;for(var a in r)r.hasOwnProperty(a)&&(e=r[a],(t=n[a])?t.array=e.typedArray.array:i.setAttribute(a,e.bufferAttribute),e.bufferAttribute.needsUpdate=!0);this.geometry.setDrawRange(0,this.particleCount)},M.Group.prototype.addEmitter=function(e){if(e instanceof M.Emitter!=!1)if(this.emitterIDs.indexOf(e.uuid)>-1)console.error("Emitter already exists in this group. Will not add again.");else{if(null===e.group){var t=this.attributes,r=this.particleCount,i=r+e.particleCount;for(var n in this.particleCount=i,null!==this.maxParticleCount&&this.particleCount>this.maxParticleCount&&console.warn("SPE.Group: maxParticleCount exceeded. Requesting",this.particleCount,"particles, can support only",this.maxParticleCount),e._calculatePPSValue(e.maxAge._value+e.maxAge._spread),e._setBufferUpdateRanges(this.attributeKeys),e._setAttributeOffset(r),e.group=this,e.attributes=this.attributes,t)t.hasOwnProperty(n)&&t[n]._createBufferAttribute(null!==this.maxParticleCount?this.maxParticleCount:this.particleCount);for(var a=r;a<i;++a)e._assignPositionValue(a),e._assignForceValue(a,"velocity"),e._assignForceValue(a,"acceleration"),e._assignAbsLifetimeValue(a,"opacity"),e._assignAbsLifetimeValue(a,"size"),e._assignAngleValue(a),e._assignRotationValue(a),e._assignParamsValue(a),e._assignColorValue(a);return this._applyAttributesToGeometry(),this.emitters.push(e),this.emitterIDs.push(e.uuid),this._updateDefines(e),this.material.needsUpdate=!0,this.geometry.needsUpdate=!0,this._attributesNeedRefresh=!0,this}console.error("Emitter already belongs to another group. Will not add to requested group.")}else console.error("`emitter` argument must be instance of SPE.Emitter. Was provided with:",e)},M.Group.prototype.removeEmitter=function(e){var t=this.emitterIDs.indexOf(e.uuid);if(e instanceof M.Emitter!=!1)if(-1!==t){for(var r=e.attributeOffset,i=r+e.particleCount,n=this.attributes.params.typedArray,a=r;a<i;++a)n.array[4*a]=0,n.array[4*a+1]=0;for(var o in this.emitters.splice(t,1),this.emitterIDs.splice(t,1),this.attributes)this.attributes.hasOwnProperty(o)&&this.attributes[o].splice(r,i);this.particleCount-=e.particleCount,e._onRemove(),this._attributesNeedRefresh=!0}else console.error("Emitter does not exist in this group. Will not remove.");else console.error("`emitter` argument must be instance of SPE.Emitter. Was provided with:",e)},M.Group.prototype.getFromPool=function(){var e=this._pool,t=this._createNewWhenPoolEmpty;if(e.length)return e.pop();if(t){var r=new M.Emitter(this._poolCreationSettings);return this.addEmitter(r),r}return null},M.Group.prototype.releaseIntoPool=function(e){if(e instanceof M.Emitter!=!1)return e.reset(),this._pool.unshift(e),this;console.error("Argument is not instanceof SPE.Emitter:",e)},M.Group.prototype.getPool=function(){return this._pool},M.Group.prototype.addPool=function(e,t,r){var i;this._poolCreationSettings=t,this._createNewWhenPoolEmpty=!!r;for(var n=0;n<e;++n)i=Array.isArray(t)?new M.Emitter(t[n]):new M.Emitter(t),this.addEmitter(i),this.releaseIntoPool(i);return this},M.Group.prototype._triggerSingleEmitter=function(e){var t=this.getFromPool(),r=this;if(null!==t)return e instanceof b.Vector3&&(t.position.value.copy(e),t.position.value=t.position.value),t.enable(),setTimeout((function(){t.disable(),r.releaseIntoPool(t)}),1e3*Math.max(t.duration,t.maxAge.value+t.maxAge.spread)),this;console.log("SPE.Group pool ran out.")},M.Group.prototype.triggerPoolEmitter=function(e,t){if("number"==typeof e&&e>1)for(var r=0;r<e;++r)this._triggerSingleEmitter(t);else this._triggerSingleEmitter(t);return this},M.Group.prototype._updateUniforms=function(e){this.uniforms.runTime.value+=e,this.uniforms.deltaTime.value=e},M.Group.prototype._resetBufferRanges=function(){for(var e=this.attributeKeys,t=this.attributeCount-1,r=this.attributes;t>=0;--t)r[e[t]].resetUpdateRange()},M.Group.prototype._updateBuffers=function(e){for(var t,r,i,n=this.attributeKeys,a=this.attributeCount-1,o=this.attributes,s=e.bufferUpdateRanges;a>=0;--a)r=s[t=n[a]],(i=o[t]).setUpdateRange(r.min,r.max),i.flagUpdate()},M.Group.prototype.tick=function(e){var t=this.emitters,r=t.length,i=e||this.fixedTimeStep,n=this.attributeKeys,a=this.attributes;if(this._updateUniforms(i),this._resetBufferRanges(),0!==r||!1!==this._attributesNeedRefresh||!1!==this._attributesNeedDynamicReset){for(var o,s=0;s<r;++s)(o=t[s]).tick(i),this._updateBuffers(o);if(!0===this._attributesNeedDynamicReset){for(s=this.attributeCount-1;s>=0;--s)a[n[s]].resetDynamic();this._attributesNeedDynamicReset=!1}if(!0===this._attributesNeedRefresh){for(s=this.attributeCount-1;s>=0;--s)a[n[s]].forceUpdateAll();this._attributesNeedRefresh=!1,this._attributesNeedDynamicReset=!0}}},M.Group.prototype.dispose=function(){return this.geometry.dispose(),this.material.dispose(),this},M.Emitter=function(e){var t=M.utils,r=t.types,i=M.valueOverLifetimeLength;for(var n in(e=t.ensureTypedArg(e,r.OBJECT,{})).position=t.ensureTypedArg(e.position,r.OBJECT,{}),e.velocity=t.ensureTypedArg(e.velocity,r.OBJECT,{}),e.acceleration=t.ensureTypedArg(e.acceleration,r.OBJECT,{}),e.radius=t.ensureTypedArg(e.radius,r.OBJECT,{}),e.drag=t.ensureTypedArg(e.drag,r.OBJECT,{}),e.rotation=t.ensureTypedArg(e.rotation,r.OBJECT,{}),e.color=t.ensureTypedArg(e.color,r.OBJECT,{}),e.opacity=t.ensureTypedArg(e.opacity,r.OBJECT,{}),e.size=t.ensureTypedArg(e.size,r.OBJECT,{}),e.angle=t.ensureTypedArg(e.angle,r.OBJECT,{}),e.wiggle=t.ensureTypedArg(e.wiggle,r.OBJECT,{}),e.maxAge=t.ensureTypedArg(e.maxAge,r.OBJECT,{}),e.onParticleSpawn&&console.warn("onParticleSpawn has been removed. Please set properties directly to alter values at runtime."),this.uuid=b.MathUtils.generateUUID(),this.type=t.ensureTypedArg(e.type,r.NUMBER,M.distributions.BOX),this.position={_value:t.ensureInstanceOf(e.position.value,b.Vector3,new b.Vector3),_spread:t.ensureInstanceOf(e.position.spread,b.Vector3,new b.Vector3),_spreadClamp:t.ensureInstanceOf(e.position.spreadClamp,b.Vector3,new b.Vector3),_distribution:t.ensureTypedArg(e.position.distribution,r.NUMBER,this.type),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,!1),_radius:t.ensureTypedArg(e.position.radius,r.NUMBER,10),_radiusScale:t.ensureInstanceOf(e.position.radiusScale,b.Vector3,new b.Vector3(1,1,1)),_distributionClamp:t.ensureTypedArg(e.position.distributionClamp,r.NUMBER,0)},this.velocity={_value:t.ensureInstanceOf(e.velocity.value,b.Vector3,new b.Vector3),_spread:t.ensureInstanceOf(e.velocity.spread,b.Vector3,new b.Vector3),_distribution:t.ensureTypedArg(e.velocity.distribution,r.NUMBER,this.type),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,!1)},this.acceleration={_value:t.ensureInstanceOf(e.acceleration.value,b.Vector3,new b.Vector3),_spread:t.ensureInstanceOf(e.acceleration.spread,b.Vector3,new b.Vector3),_distribution:t.ensureTypedArg(e.acceleration.distribution,r.NUMBER,this.type),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,!1)},this.drag={_value:t.ensureTypedArg(e.drag.value,r.NUMBER,0),_spread:t.ensureTypedArg(e.drag.spread,r.NUMBER,0),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,!1)},this.wiggle={_value:t.ensureTypedArg(e.wiggle.value,r.NUMBER,0),_spread:t.ensureTypedArg(e.wiggle.spread,r.NUMBER,0)},this.rotation={_axis:t.ensureInstanceOf(e.rotation.axis,b.Vector3,new b.Vector3(0,1,0)),_axisSpread:t.ensureInstanceOf(e.rotation.axisSpread,b.Vector3,new b.Vector3),_angle:t.ensureTypedArg(e.rotation.angle,r.NUMBER,0),_angleSpread:t.ensureTypedArg(e.rotation.angleSpread,r.NUMBER,0),_static:t.ensureTypedArg(e.rotation.static,r.BOOLEAN,!1),_center:t.ensureInstanceOf(e.rotation.center,b.Vector3,this.position._value.clone()),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,!1)},this.maxAge={_value:t.ensureTypedArg(e.maxAge.value,r.NUMBER,2),_spread:t.ensureTypedArg(e.maxAge.spread,r.NUMBER,0)},this.color={_value:t.ensureArrayInstanceOf(e.color.value,b.Color,new b.Color),_spread:t.ensureArrayInstanceOf(e.color.spread,b.Vector3,new b.Vector3),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,!1)},this.opacity={_value:t.ensureArrayTypedArg(e.opacity.value,r.NUMBER,1),_spread:t.ensureArrayTypedArg(e.opacity.spread,r.NUMBER,0),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,!1)},this.size={_value:t.ensureArrayTypedArg(e.size.value,r.NUMBER,1),_spread:t.ensureArrayTypedArg(e.size.spread,r.NUMBER,0),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,!1)},this.angle={_value:t.ensureArrayTypedArg(e.angle.value,r.NUMBER,0),_spread:t.ensureArrayTypedArg(e.angle.spread,r.NUMBER,0),_randomise:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,!1)},this.particleCount=t.ensureTypedArg(e.particleCount,r.NUMBER,100),this.duration=t.ensureTypedArg(e.duration,r.NUMBER,null),this.isStatic=t.ensureTypedArg(e.isStatic,r.BOOLEAN,!1),this.activeMultiplier=t.ensureTypedArg(e.activeMultiplier,r.NUMBER,1),this.direction=t.ensureTypedArg(e.direction,r.NUMBER,1),this.alive=t.ensureTypedArg(e.alive,r.BOOLEAN,!0),this.particlesPerSecond=0,this.activationIndex=0,this.attributeOffset=0,this.attributeEnd=0,this.age=0,this.activeParticleCount=0,this.group=null,this.attributes=null,this.paramsArray=null,this.resetFlags={position:t.ensureTypedArg(e.position.randomise,r.BOOLEAN,!1)||t.ensureTypedArg(e.radius.randomise,r.BOOLEAN,!1),velocity:t.ensureTypedArg(e.velocity.randomise,r.BOOLEAN,!1),acceleration:t.ensureTypedArg(e.acceleration.randomise,r.BOOLEAN,!1)||t.ensureTypedArg(e.drag.randomise,r.BOOLEAN,!1),rotation:t.ensureTypedArg(e.rotation.randomise,r.BOOLEAN,!1),rotationCenter:t.ensureTypedArg(e.rotation.randomise,r.BOOLEAN,!1),size:t.ensureTypedArg(e.size.randomise,r.BOOLEAN,!1),color:t.ensureTypedArg(e.color.randomise,r.BOOLEAN,!1),opacity:t.ensureTypedArg(e.opacity.randomise,r.BOOLEAN,!1),angle:t.ensureTypedArg(e.angle.randomise,r.BOOLEAN,!1)},this.updateFlags={},this.updateCounts={},this.updateMap={maxAge:"params",position:"position",velocity:"velocity",acceleration:"acceleration",drag:"acceleration",wiggle:"params",rotation:"rotation",size:"size",color:"color",opacity:"opacity",angle:"angle"},this.updateMap)this.updateMap.hasOwnProperty(n)&&(this.updateCounts[this.updateMap[n]]=0,this.updateFlags[this.updateMap[n]]=!1,this._createGetterSetters(this[n],n));this.bufferUpdateRanges={},this.attributeKeys=null,this.attributeCount=0,t.ensureValueOverLifetimeCompliance(this.color,i,i),t.ensureValueOverLifetimeCompliance(this.opacity,i,i),t.ensureValueOverLifetimeCompliance(this.size,i,i),t.ensureValueOverLifetimeCompliance(this.angle,i,i)},M.Emitter.constructor=M.Emitter,M.Emitter.prototype._createGetterSetters=function(e,t){var r=this;for(var i in e)if(e.hasOwnProperty(i)){var n=i.replace("_","");Object.defineProperty(e,n,{get:function(e){return function(){return this[e]}}(i),set:function(e){return function(i){var n=r.updateMap[t],a=this[e],o=M.valueOverLifetimeLength;"_rotationCenter"===e?(r.updateFlags.rotationCenter=!0,r.updateCounts.rotationCenter=0):"_randomise"===e?r.resetFlags[n]=i:(r.updateFlags[n]=!0,r.updateCounts[n]=0),r.group._updateDefines(),this[e]=i,Array.isArray(a)&&M.utils.ensureValueOverLifetimeCompliance(r[t],o,o)}}(i)})}},M.Emitter.prototype._setBufferUpdateRanges=function(e){this.attributeKeys=e,this.attributeCount=e.length;for(var t=this.attributeCount-1;t>=0;--t)this.bufferUpdateRanges[e[t]]={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY}},M.Emitter.prototype._calculatePPSValue=function(e){var t=this.particleCount;this.duration?this.particlesPerSecond=t/(e<this.duration?e:this.duration):this.particlesPerSecond=t/e},M.Emitter.prototype._setAttributeOffset=function(e){this.attributeOffset=e,this.activationIndex=e,this.activationEnd=e+this.particleCount},M.Emitter.prototype._assignValue=function(e,t){switch(e){case"position":this._assignPositionValue(t);break;case"velocity":case"acceleration":this._assignForceValue(t,e);break;case"size":case"opacity":this._assignAbsLifetimeValue(t,e);break;case"angle":this._assignAngleValue(t);break;case"params":this._assignParamsValue(t);break;case"rotation":this._assignRotationValue(t);break;case"color":this._assignColorValue(t)}},M.Emitter.prototype._assignPositionValue=function(e){var t=M.distributions,r=M.utils,i=this.position,n=this.attributes.position,a=i._value,o=i._spread;switch(i._distribution){case t.BOX:r.randomVector3(n,e,a,o,i._spreadClamp);break;case t.SPHERE:r.randomVector3OnSphere(n,e,a,i._radius,i._spread.x,i._radiusScale,i._spreadClamp.x,i._distributionClamp||this.particleCount);break;case t.DISC:r.randomVector3OnDisc(n,e,a,i._radius,i._spread.x,i._radiusScale,i._spreadClamp.x);break;case t.LINE:r.randomVector3OnLine(n,e,a,o)}},M.Emitter.prototype._assignForceValue=function(e,t){var r,i,n,a,o,s=M.distributions,u=M.utils,l=this[t],c=l._value,p=l._spread;switch(l._distribution){case s.BOX:u.randomVector3(this.attributes[t],e,c,p);break;case s.SPHERE:i=(r=this.attributes.position.typedArray.array)[o=3*e],n=r[o+1],a=r[o+2],u.randomDirectionVector3OnSphere(this.attributes[t],e,i,n,a,this.position._value,l._value.x,l._spread.x);break;case s.DISC:i=(r=this.attributes.position.typedArray.array)[o=3*e],n=r[o+1],a=r[o+2],u.randomDirectionVector3OnDisc(this.attributes[t],e,i,n,a,this.position._value,l._value.x,l._spread.x);break;case s.LINE:u.randomVector3OnLine(this.attributes[t],e,c,p)}if("acceleration"===t){var h=u.clamp(u.randomFloat(this.drag._value,this.drag._spread),0,1);this.attributes.acceleration.typedArray.array[4*e+3]=h}},M.Emitter.prototype._assignAbsLifetimeValue=function(e,t){var r,i=this.attributes[t].typedArray,n=this[t],a=M.utils;a.arrayValuesAreEqual(n._value)&&a.arrayValuesAreEqual(n._spread)?(r=Math.abs(a.randomFloat(n._value[0],n._spread[0])),i.setVec4Components(e,r,r,r,r)):i.setVec4Components(e,Math.abs(a.randomFloat(n._value[0],n._spread[0])),Math.abs(a.randomFloat(n._value[1],n._spread[1])),Math.abs(a.randomFloat(n._value[2],n._spread[2])),Math.abs(a.randomFloat(n._value[3],n._spread[3])))},M.Emitter.prototype._assignAngleValue=function(e){var t,r=this.attributes.angle.typedArray,i=this.angle,n=M.utils;n.arrayValuesAreEqual(i._value)&&n.arrayValuesAreEqual(i._spread)?(t=n.randomFloat(i._value[0],i._spread[0]),r.setVec4Components(e,t,t,t,t)):r.setVec4Components(e,n.randomFloat(i._value[0],i._spread[0]),n.randomFloat(i._value[1],i._spread[1]),n.randomFloat(i._value[2],i._spread[2]),n.randomFloat(i._value[3],i._spread[3]))},M.Emitter.prototype._assignParamsValue=function(e){this.attributes.params.typedArray.setVec4Components(e,this.isStatic?1:0,0,Math.abs(M.utils.randomFloat(this.maxAge._value,this.maxAge._spread)),M.utils.randomFloat(this.wiggle._value,this.wiggle._spread))},M.Emitter.prototype._assignRotationValue=function(e){this.attributes.rotation.typedArray.setVec3Components(e,M.utils.getPackedRotationAxis(this.rotation._axis,this.rotation._axisSpread),M.utils.randomFloat(this.rotation._angle,this.rotation._angleSpread),this.rotation._static?0:1),this.attributes.rotationCenter.typedArray.setVec3(e,this.rotation._center)},M.Emitter.prototype._assignColorValue=function(e){M.utils.randomColorAsHex(this.attributes.color,e,this.color._value,this.color._spread)},M.Emitter.prototype._resetParticle=function(e){for(var t,r,i=this.resetFlags,n=this.updateFlags,a=this.updateCounts,o=this.attributeKeys,s=this.attributeCount-1;s>=0;--s)r=n[t=o[s]],!0!==i[t]&&!0!==r||(this._assignValue(t,e),this._updateAttributeUpdateRange(t,e),!0===r&&a[t]===this.particleCount?(n[t]=!1,a[t]=0):1==r&&++a[t])},M.Emitter.prototype._updateAttributeUpdateRange=function(e,t){var r=this.bufferUpdateRanges[e];r.min=Math.min(t,r.min),r.max=Math.max(t,r.max)},M.Emitter.prototype._resetBufferRanges=function(){for(var e,t=this.bufferUpdateRanges,r=this.bufferUpdateKeys,i=this.bufferUpdateCount-1;i>=0;--i)t[e=r[i]].min=Number.POSITIVE_INFINITY,t[e].max=Number.NEGATIVE_INFINITY},M.Emitter.prototype._onRemove=function(){this.particlesPerSecond=0,this.attributeOffset=0,this.activationIndex=0,this.activeParticleCount=0,this.group=null,this.attributes=null,this.paramsArray=null,this.age=0},M.Emitter.prototype._decrementParticleCount=function(){--this.activeParticleCount},M.Emitter.prototype._incrementParticleCount=function(){++this.activeParticleCount},M.Emitter.prototype._checkParticleAges=function(e,t,r,i){for(var n,a,o,s,u=t-1;u>=e;--u)0!==(s=r[n=4*u])&&(o=r[n+1],a=r[n+2],1===this.direction?(o+=i)>=a&&(o=0,s=0,this._decrementParticleCount()):(o-=i)<=0&&(o=a,s=0,this._decrementParticleCount()),r[n]=s,r[n+1]=o,this._updateAttributeUpdateRange("params",u))},M.Emitter.prototype._activateParticles=function(e,t,r,i){for(var n,a,o=this.direction,s=e;s<t;++s)0!=r[n=4*s]&&1!==this.particleCount||(this._incrementParticleCount(),r[n]=1,this._resetParticle(s),a=i*(s-e),r[n+1]=-1===o?r[n+2]-a:a,this._updateAttributeUpdateRange("params",s))},M.Emitter.prototype.tick=function(e){if(!this.isStatic){null===this.paramsArray&&(this.paramsArray=this.attributes.params.typedArray.array);var t=this.attributeOffset,r=t+this.particleCount,i=this.paramsArray,n=this.particlesPerSecond*this.activeMultiplier*e,a=this.activationIndex;if(this._resetBufferRanges(),this._checkParticleAges(t,r,i,e),!1!==this.alive){if(null!==this.duration&&this.age>this.duration)return this.alive=!1,void(this.age=0);var o=1===this.particleCount?a:0|a,s=Math.min(o+n,this.activationEnd),u=s-this.activationIndex|0,l=u>0?e/u:0;this._activateParticles(o,s,i,l),this.activationIndex+=n,this.activationIndex>r&&(this.activationIndex=t),this.age+=e}else this.age=0}},M.Emitter.prototype.reset=function(e){if(this.age=0,this.alive=!1,!0===e){for(var t,r=this.attributeOffset,i=r+this.particleCount,n=this.paramsArray,a=this.attributes.params.bufferAttribute,o=i-1;o>=r;--o)n[t=4*o]=0,n[t+1]=0;a.updateRange.offset=0,a.updateRange.count=-1,a.needsUpdate=!0}return this},M.Emitter.prototype.enable=function(){return this.alive=!0,this},M.Emitter.prototype.disable=function(){return this.alive=!1,this},M.Emitter.prototype.remove=function(){return null!==this.group?this.group.removeEmitter(this):console.error("Emitter does not belong to a group, cannot remove."),this};var I="data:image/png;base64,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",O={vertexShader:"\n  #include <common>\n  #include <logdepthbuf_pars_vertex>\n  uniform float pixelRatio;\n  uniform float time;\n  attribute float size;  \n  attribute float speed;  \n  attribute float opacity;\n  attribute vec3 noise;\n  attribute vec3 color;\n  varying vec3 vColor;\n  varying float vOpacity;\n  void main() {\n    vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n    modelPosition.y += sin(time * speed + modelPosition.x * noise.x * 100.0) * 0.2;\n    modelPosition.z += cos(time * speed + modelPosition.x * noise.y * 100.0) * 0.2;\n    modelPosition.x += cos(time * speed + modelPosition.x * noise.z * 100.0) * 0.2;\n    vec4 viewPosition = viewMatrix * modelPosition;\n    vec4 projectionPostion = projectionMatrix * viewPosition;\n    gl_Position = projectionPostion;\n    gl_PointSize = size * 25. * pixelRatio;\n    gl_PointSize *= (1.0 / - viewPosition.z);\n    vColor = color;\n    vOpacity = opacity;\n\n\t  #include <logdepthbuf_vertex>\n  }",fragmentShader:"\n  #include <common>\n  #include <logdepthbuf_pars_fragment>\n  varying vec3 vColor;\n  varying float vOpacity;\n  void main() {\n    float distanceToCenter = distance(gl_PointCoord, vec2(0.5));\n    float strength = 0.05 / distanceToCenter - 0.1;\n    gl_FragColor = vec4(vColor, strength * vOpacity);\n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    #include <logdepthbuf_fragment>\n  }"};const S=e=>e&&e.constructor===Float32Array,T=e=>[e.r,e.g,e.b],P=e=>void 0!==(null==e?void 0:e.x)&&void 0!==(null==e?void 0:e.y)&&void 0!==(null==e?void 0:e.z),R=e=>Array.isArray(e)?e:P(e)?[e.x,e.y,e.z]:[e,e,e];function G(e,t,r){if(void 0!==t){if(S(t))return t;if(t instanceof w){const r=Array.from({length:3*e},(()=>T(t))).flat();return Float32Array.from(r)}if(P(t)||Array.isArray(t)){const r=Array.from({length:3*e},(()=>R(t))).flat();return Float32Array.from(r)}return Float32Array.from({length:e},(()=>t))}return Float32Array.from({length:e},r)}const L={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float h;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 sum = vec4( 0.0 );\n\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\n\n\t\t\tgl_FragColor = sum;\n\n\t\t}"},U={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float v;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 sum = vec4( 0.0 );\n\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\n\n\t\t\tgl_FragColor = sum;\n\n\t\t}"};var Q,N=Object.defineProperty,F=(e,t,r)=>(((e,t,r)=>{t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r),z=(e=>(e[e.x=0]="x",e[e.y=1]="y",e[e.z=2]="z",e))(z||{});function H(i){return void 0!==i.w?[e,4]:void 0!==i.z?[t,3]:[r,2]}function k(e,t,r){let i=function(e,t){const r=Math.sqrt(e.lengthSq()*t.lengthSq());if(0===r)return 0;let i=e.dot(t)/r;return i=Math.max(-1,Math.min(1,i)),Math.acos(i)}(e,t);return 0===i?i:e.clone().cross(t).dot(r)<0?-i:i}(Q=z||(z={})).toKey=function(e){return Q[e]},Q.toIndex=function(e){return Q[e]};const V=180/Math.PI,Y={yaw:[{name:"",range:[-15,15]},{name:"",range:[15,165]},{name:"",range:[-165,-15]},{name:"",range:[-180.1,-165]},{name:"",range:[165,180.1]}],pitch:[{name:"",range:[-15,15]},{name:"",range:[15,165]},{name:"",range:[-165,-15]},{name:"",range:[-180.1,-165]},{name:"",range:[165,180.1]}],roll:[{name:"",range:[-15,15]},{name:"",range:[15,165]},{name:"",range:[-165,-15]},{name:"",range:[-180.1,-165]},{name:"",range:[165,180.1]}]};const j={degrees:!0,map:Y,front:{x:0,y:0,z:1},up:{x:0,y:1,z:0}};class W{constructor(e){F(this,"_options"),F(this,"_listMap"),F(this,"_front"),F(this,"_up"),e&&(this.options=e)}static get options(){return this._options??(this.options=j)}static set options(e){this._options=Object.assign({},structuredClone(Y),e)}get defaultOptions(){return this.constructor.options}get options(){return this._options??(this.options=this.defaultOptions)}set options(e){this._options=Object.assign({},structuredClone(this.defaultOptions),e),this._listMap=null,this._front=null,this._up=null}get degrees(){return this.options.degrees??(this.options.degrees=this.defaultOptions.degrees??!0)}set degrees(e){this.options.degrees=e}get map(){return this.options.map||(this.map=this.defaultOptions.map),this.options.map}set map(e){const t=structuredClone(this.defaultOptions.map),r=structuredClone(Y);e=e?{yaw:e.yaw??t.yaw??r.yaw,pitch:e.pitch??t.pitch??r.pitch,roll:e.roll??t.roll??r.roll}:t,this.options.map=e,this._listMap=null}get listMap(){return this._listMap??(this._listMap=function(e){const t={};for(const[r,i]of Object.entries(e))t[r]=Array.isArray(i)?i:Object.entries(i).map((([e,t])=>({name:e,range:t})));return t}(this.map??{}))}get front(){return this._front||(this.front=this.options.front??this.defaultOptions.front??j.front),this._front}set front(e){this._front=(new t).copy(e)}get up(){return this._up||(this.up=this.options.up??this.defaultOptions.up??j.up),this._up}set up(e){this._up=(new t).copy(e)}computeAzimuth(e,r,i){const n=(new t).copy(e),a=(new t).copy(r??this.front),o=(new t).copy(i??this.up);let{yaw:s,pitch:u,roll:l}=function(e,t,r){const i=t.clone().negate(),n=r.clone().projectOnPlane(t),a=k(t,e.clone().projectOnPlane(n),n),o=t.clone().cross(n);return{yaw:a,pitch:k(t,e.clone().projectOnPlane(o),o),roll:k(n,e.clone().projectOnPlane(i),i)}}(n,a,o);return this.degrees&&(s*=V,u*=V,l*=V),{yaw:{angle:s,name:this.findAzimuthNames("yaw",s)},pitch:{angle:u,name:this.findAzimuthNames("pitch",u)},roll:{angle:l,name:this.findAzimuthNames("roll",l)}}}findAzimuthNames(e,t){const r=[],i=this.listMap[e];if(!i)return r;for(const{name:e,range:[n,a]}of i)(t>=n&&t<a||t<=n&&t>a)&&r.push(e);return r}}F(W,"_options"),new W;var J=Object.defineProperty,K=(e,t,r)=>(((e,t,r)=>{t in e?J(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);function Z(e){const t=[];for(let r=0;r<e;r++)t.push(i.randFloatSpread(2));return t}function X(e,t,r){const i=[],n=e-1;for(let e=0;e<n;e++){const e=2*(Math.random()-.5)*(t+r);i.push(e)}const a=Math.trunc(Math.random()*e);let o=2*(Math.random()-.5)*r;return o+=Math.sign(o)*t,i.splice(a,0,o),i}function _(e,t){const r=[],n=e-1;for(let e=0;e<n;e++)r.push(i.randFloatSpread(2));return r.push(Math.random()*t),r}function q(e,t,r,i){const n=[],a=e-1,o=a-1;for(let e=0;e<o;e++){const e=2*(Math.random()-.5)*(t+r);n.push(e)}const s=Math.trunc(Math.random()*a);let u=2*(Math.random()-.5)*r;return u+=Math.sign(u)*t,n.splice(s,0,u),n.push(Math.random()*i),n}function $(e){let t=[];for(let r=0;r<e;r++)t.push(i.randFloatSpread(2));const r=Math.hypot(...t),n=Math.random()/r;return t=t.map((e=>e*n)),t}function ee(e,t,r){let n=[];for(let t=0;t<e;t++)n.push(i.randFloatSpread(2));const a=Math.hypot(...n),o=(Math.random()*r+t)/a;return n=n.map((e=>e*o)),n}function te(e,t){let r=[];const n=e-1;for(let e=0;e<n;e++)r.push(i.randFloatSpread(2));const a=Math.hypot(...r),o=Math.random()/a;return r=r.map((e=>e*o)),r.push(Math.random()*t),r}function re(e,t,r,n){let a=[];const o=e-1;for(let e=0;e<o;e++)a.push(i.randFloatSpread(2));const s=Math.hypot(...a),u=(Math.random()*r+t)/s;return a=a.map((e=>e*u)),a.push(Math.random()*n),a}function ie({ratio:e,density:t}){return t-t*e}function ne({ratio:e,value:t}){return t-t*e}var ae=(e=>(e[e.Circle=0]="Circle",e[e.Square=1]="Square",e))(ae||{});function oe(e,r){const{clim:i,step:n,radius:a,value:o,solid:s,hollow:u,density:l,shape:c,densityGradient:p,valueGradient:h}=e,d=e,[A,g]=H(e);let f,y;if(r){const{lineStep:e,matrix:i}=r,n=1===c?q:re;f=function(r,a,o){const s=n(r,a,o,e);return 2===r&&s.push(0),new t(...s).applyMatrix4(i)},y=function(t,r){return t*r**(g-2)*e}}else{const e=1===c?X:ee;f=function(t,r,i){const n=e(t,r,i);return new A(...n)},y=function(e,t){return e*t**(g-1)}}const m=[],v=[],x=a*s,w=a-x,C=a*u;for(let e=C+n;e<a;e+=n){const t={ratio:(e-x)/w,radius:a,solid:s,distance:e,density:l,solidRadius:x,gradientRadius:w,clim:i,value:o,hollow:u,hollowRadius:C};let r=y(e<x?l:p(t),e);const c=e-n;for(;r-- >-1;){const e=f(g,c,n),r=(new A).copy(e),i=r.length();r.add(d),m.push(r);const o=h({...t,ratio:i/a,distance:i});v.push(o)}}return{particles:m,values:v}}function se(e){const{points:t,clim:r={x:0,y:100},step:i=3,radius:n=10,value:a=100,solid:o=.7,hollow:s=0,density:u=1,shape:l=0,densityGradient:c=ie,valueGradient:p=ne}=e,h={clim:r,step:i,radius:n,value:a,solid:o,hollow:s,density:u,shape:l,densityGradient:c,valueGradient:p},d=t[0];if(!d)return[];const[A,g]=H(d);return t.map((e=>{const t=new A;return Object.assign(t,{...h,...e}),oe(t)}))}class ue extends n{constructor(e){super(),K(this,"isClusterGeometry",!0),K(this,"_options"),K(this,"_colorGradient"),K(this,"_values"),e&&(this.options=e)}get options(){return this._options??(this._options={})}set options(e){this._options=e,this.updateVertices()}get gradient(){return this.options.gradient}set gradient(e){this.options.gradient=e,this.colorGradient=this.createColorGradient(e)}get colorGradient(){return this._colorGradient?this._colorGradient:this._colorGradient=this.createColorGradient(this.gradient)}set colorGradient(e){this._colorGradient=e,this.updateVertexColors()}createColorGradient(e){if(!e)return null;const t=Array.isArray(e)?function(e,t,r){const i=document.createElement("canvas");i.width=t,i.height=r;const n=i.getContext("2d"),a=n.createLinearGradient(0,0,256,1);for(const[t,r]of e)a.addColorStop(Number(t),r);return n.fillStyle=a,n.fillRect(0,0,t,r),document.body.append(i),n.getImageData(0,0,t,r)}(e,256,1):e,{width:r,height:i}=t,n=function(e,t){const{data:r,width:i}=e,n=t*i,a=n+i;return r.slice(4*n,4*a)}(t,Math.trunc(i/2));return new ImageData(n,r,1)}updateVertexColors(){this.deleteAttribute("color");const{colorGradient:e,clim:t,values:r}=this;if(!e)return!1;const{width:n,data:o}=e,s=[],{x:u,y:l}=t,c=l-u,p=n-1;for(const e of r){const t=1-(i.clamp(e,u,l)-u)/c,r=4*Math.trunc(t*p),n=o.slice(r,r+4);s.push(...n)}this.setAttribute("color",new a(new Uint8ClampedArray(s),4,!0))}get clim(){return this.options.clim??(this.options.clim={x:0,y:100})}set clim(e){this.options.clim=e,this.updateVertexColors()}get clusters(){return this.options.clusters}set clusters(e){this.options.clusters=e,this.updateVertices()}updateVertices(){this.deleteAttribute("position"),this._values=null;const e=this.clusters;if(!e)return;const t=[],r=[];let i=0;for(const{particles:n,values:a}of e){const e=n.length;for(let o=0;o<e;o++,i++){n[o].toArray(t,3*i);const e=a[o];r.push(e)}}this.setAttribute("position",new a(new Float32Array(t),3)),this.values=r}get values(){return this._values??(this._values=[])}set values(e){this._values=e,this.updateVertexColors()}addCluster(e){const t=Array.isArray(e)?e:[e],r=this.clusters;if(!r)return void(this.clusters=t);r.push.apply(r,t);let i=[];const n=[];let o=0;for(const{particles:e,values:r}of t){const t=e.length;for(let a=0;a<t;a++,o++){e[a].toArray(i,3*o);const t=r[a];n.push(t)}}const s=this.getAttribute("position");s&&(i=[...s.array,...i]),this.setAttribute("position",new a(new Float32Array(i),3)),s?this.addValueColors(n):this.values=n}addValueColors(e){const{colorGradient:t,clim:r,values:n}=this;if(!t)return!1;const{width:o,data:s}=t;let u=[];const{x:l,y:c}=r,p=c-l,h=o-1;for(const t of e){const e=1-(i.clamp(t,l,c)-l)/p,r=4*Math.trunc(e*h),a=s.slice(r,r+4);u.push(...a),n.push(t)}const d=this.getAttribute("color");d&&(u=[...d.array,...u]),this.setAttribute("color",new a(new Uint8ClampedArray(u),4,!0))}}function le({startRadius:e,addedRadius:t,ratio:r}){return t*r+e}function ce({startDensity:e,addedDensity:t,ratio:r}){return t*r+e}function pe({startValue:e,addedValue:t,ratio:r}){return t*r+e}function he(e){const{points:r,clim:i={x:0,y:100},step:n=3,radius:a=10,value:o=100,solid:s=.7,hollow:c=0,density:p=1,shape:h=ae.Circle,densityGradient:d=ie,valueGradient:A=ne,radiusGradient:g=le,lineDensityGradient:f=ce,lineValueGradient:y=pe}=e,m=e.lineStep??n,v={clim:i,step:n,radius:a,value:o,solid:s,hollow:c,density:p,shape:h,densityGradient:d,valueGradient:A,radiusGradient:g,lineDensityGradient:f},{total:x,lengths:w}=function(e){const t=e.length;let r=e[0];const[i,n]=H(r),a=[0];let o=0;for(let n=1;n<t;n++){const t=(new i).copy(e[n]).distanceTo(r);a.push(t),o+=t}return{lengths:a,total:o}}(r),C=r.length,E=r[0],b=r[C-1],B=E.radius??a,D=E.density??p,M=E.value??o,I=b.radius??a,O=b.density??p,S=b.value??o,T={length:x,startRadius:B,endRadius:I,addedRadius:I-B,defaultRadius:a,startDensity:D,endDensity:O,addedDensity:O-D,defaultDensity:p,startValue:M,endValue:S,addedValue:S-M,defaultValue:o},P=[];for(let e=0;e<C;e++){const t=r[e];let{radius:i,value:n,density:a}=t;const o={...T,ratio:w[e]/x,index:e-1};i=i??g(o),a=a??f(o),n=n??y(o),P.push({...v,...t,radius:i,density:a,value:n})}const[R,G]=H(E),L=[],U=C-1;for(let e=0;e<U;e++){const r=P[e],{radius:i,density:n,value:s}=r,c=new R;c.lineStep=m;const h=P[e+1],{radius:d,density:A,value:v}=h,x=new R;Object.assign(x,h);const C=x.clone().sub(c).normalize(),E=w[e+1],b=Math.trunc(E/m),B=d-i,D=A-n,M=v-s,I=new u;3===G?I.setFromUnitVectors(new t(0,0,1),C):I.setFromUnitVectors(new t(0,1,0),new t(C.x,C.y,0));const O=(new l).makeRotationFromQuaternion(I);Object.assign(c,{...r,lineDir:C,matrix:O}),L.push(c);const S={length:E,startRadius:i,endRadius:d,addedRadius:B,defaultRadius:a,startDensity:n,endDensity:A,addedDensity:D,defaultDensity:p,startValue:s,endValue:v,addedValue:M,defaultValue:o,index:e,ratio:0};let T=0;for(let e=1;e<b;e++){T=e*m;const t=C.clone().multiplyScalar(T).add(c),i=T/E;S.ratio=i;const n=g(S),a=f(S),o=y(S),s={...r,lineDir:C,matrix:O,radius:n,density:a,value:o,lineStep:m};delete s.x,delete s.y,delete s.z,delete s.w,Object.assign(t,s),L.push(t)}L[L.length-1].lineStep=E-T}return L.map((e=>{const{lineStep:t,matrix:r}=e;return oe(e,{lineStep:t,matrix:r})}))}function de(e,t){const{x:r,y:i}=t;let n=0;for(const{value:t,clim:{x:r,y:i}}of e)n+=(t-r)/(i-r);return n*(i-r)+r}function Ae(e,t){const{clim:r,step:i,radius:n,value:a,solid:o,hollow:s,density:u,shape:l,densityGradient:c,valueGradient:p,valuesAccumulate:h}=e,[d,A]=H(e),g=(new d).copy(e),f=l===ae.Square?X:ee,y=[],m=[],v=n*o,x=n-v,w=n*s,C=t.map((e=>({dist:g.distanceTo(e),point:e})));for(let t=w+i;t<n;t+=i){const l={ratio:(t-v)/x,radius:n,solid:o,hollow:s,hollowRadius:w,distance:t,density:u,solidRadius:v,gradientRadius:x,clim:r,value:a},E=t<v?u:c(l);let b=E*t**(A-1);const B=t-i,D=C.filter((({dist:e,point:r})=>{const i=r.radius;return e-t<=i}));e:for(;b-- >-1;){const t=new d(...f(A,B,i)),a=t.length();t.add(g);const o=[],s={...l,ratio:a/n,distance:a},u=p(s);o.push({...e,...s,value:u,density:E});for(const{point:e}of D){const r=t.distanceTo(e),{solid:i,hollow:n,radius:a}=e;if(r<=a){const t=a*i,s=a-t,u=a*n;if(r<u)continue e;const l={...e,ratio:r/a,distance:r,solidRadius:t,gradientRadius:s,hollowRadius:u},c=p(l);o.push({...l,value:c})}}y.push(t);const c=h(o,r,E);m.push(c)}}return{particles:y,values:m}}function ge(e){const{points:t,clim:r={x:0,y:100},step:i=3,radius:n=10,value:a=100,solid:o=.7,hollow:s=0,density:u=1,shape:l=ae.Circle,densityGradient:c=ie,valueGradient:p=ne,valuesAccumulate:h=de}=e,d={clim:r,step:i,radius:n,value:a,solid:o,hollow:s,density:u,shape:l,densityGradient:c,valueGradient:p,valuesAccumulate:h},A=t.map((e=>({...d,...e}))),g=function(e){const t=e.length,r=[];if(0===t)return r;const[i,n]=H(e[0]);for(let n=0;n<t;n++){const a=e[n],o=(new i).copy(a),s=a.radius,u=r[n]??(r[n]=[]);for(let i=n+1;i<t;i++){const t=e[i];o.distanceToSquared(t)<=(t.radius+s)**2&&(u.push(i),(r[i]=[]).push(n))}}return r}(A);return A.map(((e,t)=>{const r=g[t].map((e=>A[e]));return Ae({...d,...e},r)}))}var fe=(e=>(e[e.Point=0]="Point",e[e.Line=1]="Line",e[e.Heat=2]="Heat",e))(fe||{});const ye={cluster:{base:["radius","solid","hollow","density","shape","densityGradient","step","clusterType","points"],line:["radiusGradient","lineDensityGradient","lineStep"],heat:[]},gradient:{base:["value","valueGradient","clim","gradient"],line:["lineValueGradient"],heat:["valuesAccumulate"]}};class me extends ue{constructor(e){super(),K(this,"isParticleClusterGeometry",!0),e&&(this.options=e)}get options(){return this._options}set options(e){this._options=e,this.updateClusters()}get clusterType(){return this.options.clusterType}set clusterType(e){this.options.clusterType!==e&&(this.options.clusterType=e,this.updateClusters())}setOptions(e){const t=this.options;let r=!1;const i=Object.entries(e).some((([e,i])=>i!==t[e]&&(!!(ye.cluster.base.includes(e)||1===this.clusterType&&ye.cluster.line.includes(e)||2===this.clusterType&&ye.cluster.heat.includes(e))||(ye.gradient.base.includes(e)&&(r=!0),1===this.clusterType&&ye.gradient.line.includes(e)&&(r=!0),void(2===this.clusterType&&ye.gradient.heat.includes(e)&&(r=!0))))));Object.assign(this.options,e),i?this.updateClusters():r&&this.updateVertexColors()}updateClusters(){this.clusters=this.createClusters(this.options)}createClusters(e){let t;switch(e.clusterType){case 2:t=ge(e);break;case 1:t=he(e);break;default:t=se(e)}return t}addPoint(e,t){const r=Array.isArray(e)?e:[e],i={...this.options,...t,points:r},n=this.createClusters(i);this.addCluster(n)}}class ve extends o{constructor(e){super(new me,new s({vertexColors:!0,transparent:!0,...e})),K(this,"isParticleCluster",!0),e&&(this.options=e)}get options(){return this.geometry.options}set options(e){const t=null==e?void 0:e.points;if(t){const r=this.convertPoints(t);e={...e,points:r}}this.geometry.options=e}setOptions(e){const t=e.points;if(t){const r=this.convertPoints(t);e={...e,points:r}}this.geometry.setOptions(e)}addPoint(e,t){const r=Array.isArray(e)?e:[e],i=this.convertPoints(r);this.geometry.addPoint(i,t)}convertPoints(e){const r=this.matrixWorld.clone().invert();return e.map((e=>{const i=new t;return Object.assign(i,e),i.applyMatrix4(r),i}))}}class xe{constructor(e){this.ssp=e,this.weatherPresetImgs={rain:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAASQSURBVHjarFfPb1RVFP7Oufe9Nz86zLSlI2DjD4xYYyFGY7QJiQu60ITEENlhIgs2hIoLjewb3bvgH8DEuDAEY1y4IKwMRYmAhGAULZGGinSmM5158+bN+3GPi04rbaf0tvUkMy95uffc73znO+fcRyKC1Tb5fYqNzNOMW/f9N6q1Ogad4EpiaMM9X32wb8073WuhbOwLfmxwr6lPLQSZZKiMKwWHIdi89QRg9OMRaAZuz0Tv3Hyg3gOV5IWsXBh5yv02Tv8nAI1OtO4GIiBJMXTzPj4lYgBC1+6Zz3YVwynNmHs8Cxk7ALON9roumAzu/KPPVFq5Ua0Xj6u01Ojl6eDM8+XkYyO8fQB+M9Nzu2Lg4UJzbKZZmFAMEGj5/b1adkJFC+ef6M9NGbPNFGQyazVAIIgxuhbmJqNEeS4LlgpIERAl7NWi7OSwI2+DObFVZE8AT+5x1y5UhLuz0UQlUONaYYV/6QqzErjjqZNOPLvH/TxJZesAdmbWHv7r783dP911P4RSoB7hEQBhxvXp9KOi8b9+bm/hfmoBoqdi0lRW/GAMHrbVmUZHPePQ+k5dNqgGzvDfTf0JGbPWjy0DP9zyV6GkV3+rZo97mpA+EjFWpSEFwWPg9pzzPn5pfZFCfl6x6M2iHYB6S1bUfb2jT7ZiFBURIL0joW4LJSYEkRSna3yymI1PmA3aak8AYTtZPlxIXm4k+WNMAEE2FDdBwAzUY++YQ+FZEtyQzWog7xLyLiGrgSB2TxvhDIisKku6yEU4047d0zkN9DmEPofsGdj3dAGKgXpgXpn5i4/CrM35Y1mQxUy1TebocNk9uyPH11KzCQbIRKC0g0YrOd5JucC0+TnHJOikXKi3kuOcdsAmsgcQhAnm/aT8R4WOMBG2aqwIf1b5SN1PymGY2ANoE8q1WB0OjDusyGwdAAxaxhmej9XhNqNsDaA6L/vnFmh8cdhsnQECAcJ4sEDjD6tmvzWAWosOtiJ1AETAlu45/9UEERBEfKDW4oP2IvScMVFqpFtT2JaJQJQeIc8ds78RhV7JQBSRQCDLc3/z8QNEgjhl1TCqZM2A55iU6ZE8bkcDICgCMtqk9p2Qgjua4orZLv0ADAiakkqe23esARTdzsWcSm7AALJdEEaQ0/GNkhtetNbAUF94yXGoONfJjy8NmM0AkaULSvcbY09f55uSF16yZkDlB2YH+71zu/LB9dgsFYKxmIXoQjUABHFK2J0Pr/cPZM9R385ZawYGyYdW4qtBPlUNvO9iowYcy45I3f9EGJ5K50eHWqeGHOMvfrrl7RjQZMAwKHhqaqRYPZFXUTMWXk7D0r1gZZ+U5fhTYeQ5ar5UrJzYkaEphoFeJwBeL4cCIBGg5EQXXuxfOJRT7csCgQjBdLcJAENLT4YRggiQ5fbl0YHGoZITX0iElv1Zp2BlIyMAdHWn135rwKm/e9cvHAvhvgbhHQZMEAJTKkSmkVHR1b15/8t67J4XoaZN0rSNort0N0s6PJdj91K/8l8v5PTYdDA4AAL25urzfiueaqfujyUnnKnHrthOkH8HAIl7DGQhmnDgAAAAAElFTkSuQmCC",snow:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAUNJREFUOE+lk78rhWEUxz/fwWAzUBYs/gMMNkp+lbKwWPgPGAySuJPxWqSUMhMpgzCwWShumSibxWJ2h6/O7Xlvb5d7da+nTk9vz3s+z/ec53vEP5ca5du+iXNJo/X++wGwvQhMp4SutH+kfVnSex5WBdjuB76AE0lDto+AKkDSvO17YE/SQQapAGwPAHG4CmwAnZLKtSXYNjALrAMLkl4ywBywAgwDJaAo6TAPSKUVgF7gAtiRdJVXMAZkEcLOgI4k9TPdHJ+RXAlJrxlgBOgBniSVbG8Bm0AkxgpQQdKW7Skg4lTSbR7QLinI0ZMoaRdoawA4l3SdAYaASWACKAOhqKkSxoHlJC0uXarTxG2gG7hLjT6ufcZ9YAboa/CMAVkDBiU95I0UXngDLv8wUhF4lPRcsXmtx1u28m/D0tIwNTvd35YVoxGOzVJ7AAAAAElFTkSuQmCC"},this._weatherId=""}createFlame(r){const{magnitude:i=1.3,gain:n=.5}=r,a=50,o=new c(new p(1,1,1),(r=>{const{imgUrl:o=E}=r,s=(new d).load(o);s.magFilter=s.minFilter=A,s.wrapS=s.wrapT=g;const u=new f({defines:{ITERATIONS:20,OCTIVES:3,WIDTH:128,BOUNDS:512},uniforms:y.merge([m.phong.uniforms,{fireTex:{type:"t",value:s},time:{type:"f",value:0},seed:{type:"f",value:19.19*Math.random()},invModelMatrix:{type:"v4",value:new l},scale:{type:"v3",value:new t(a,a,a)},noiseScale:{type:"v4",value:new e(1,2,1,.3)},magnitude:{type:"f",value:i},gain:{type:"f",value:n},lacunarity:{type:"f",value:2},diffuse:{type:"c",value:new v(16576)},specular:{type:"c",value:new v(1118481)},shininess:{type:"f",value:Math.max(50,1e-4)},opacity:{type:"f",value:.8}}]),vertexShader:C.vertexShader,fragmentShader:C.fragmentShader,transparent:!0,depthWrite:!1,depthTest:!0,lights:!0});return u.uniforms.fireTex.value=s,u})(r));o.scale.set(a,a,a);this.ssp.viewport.postUpdate.set(r.id,(e=>{const r=o.material,a=r.uniforms.invModelMatrix.value;o.updateMatrixWorld(),a.copy(o.matrixWorld).invert(),void 0!==e&&(r.uniforms.time.value=e/1e3),r.uniforms.invModelMatrix.value=a,r.uniforms.scale.value=o.getWorldScale(new t),r.uniforms.magnitude.value=i||1.3,r.uniforms.gain.value=n||.5,r.version++,this.ssp.render()}));const s=this.ssp.createPluginObject(r,o);return s.addEventListener("removed",(()=>{this.ssp.viewport.postUpdate.delete(r.id)})),s}removeFlame(e){return console.warn(" ssp.removeObjectById "),this.ssp.removeObjectById(e)}createSmoke(e){const{imgUrl:t=I,count:r=1e3,maxAge:i=4,size:n=200,acceleration:a=10,velocity:o={x:100,y:100,z:100},color:s=[3355443,1118481]}=e,{THREE:u}=this.ssp,l=new u.Clock,c=(new u.TextureLoader).load(t),p=new M.Group({texture:{value:c},blending:u.NormalBlending}),h=new M.Emitter({particleCount:r,maxAge:{value:i},position:{value:new u.Vector3(0,0,0),spread:new u.Vector3(0,0,0)},size:{value:n,spread:[1,1,8]},acceleration:{value:new u.Vector3(0,a,0)},rotation:{angle:this.ssp.utils.deg2Euler(45),randomise:!0},velocity:{value:new u.Vector3(0,100,0),spread:new u.Vector3(o.x,o.y,o.z)},opacity:{value:[.5,.2,0]},color:{value:s.map((e=>new u.Color(e)))}});p.addEmitter(h);this.ssp.viewport.postUpdate.set(e.id,(()=>{p.tick(l.getDelta()),this.ssp.render()}));const d=this.ssp.createPluginObject(e,p.mesh);return d.addEventListener("removed",(()=>{this.ssp.viewport.postUpdate.delete(e.id)})),d}removeSmoke(e){return console.warn(" removeObjectById "),this.ssp.removeObjectById(e)}createSparkles(e){const{count:t=100,scalar:r=8,speed:i=1,opacity:n=1,noise:a=1,color:o="#fff",size:s=2}=e,{ssp:u}=this,{THREE:l}=u,{Points:c,ShaderMaterial:p,BufferGeometry:d,BufferAttribute:A}=l,g=Float32Array.from(Array.from({length:t},(()=>R(r).map(l.MathUtils.randFloatSpread))).flat()),f=G(t,s,Math.random),y=G(t,n),m=G(t,i),v=G(3*t,a),x=G(void 0===o?3*t:t,S(o)?o:new l.Color(o),(()=>1)),w=new d;w.setAttribute("position",new A(g,3)),w.setAttribute("size",new A(f,1)),w.setAttribute("opacity",new A(y,1)),w.setAttribute("speed",new A(m,1)),w.setAttribute("color",new A(x,3)),w.setAttribute("noise",new A(v,3));const C=new p({uniforms:{time:{value:0},pixelRatio:{value:self.devicePixelRatio}},vertexShader:O.vertexShader,fragmentShader:O.fragmentShader,depthWrite:!1,transparent:!0,blending:h}),E=new c(w,C);this.ssp.viewport.postUpdate.set(e.id,(()=>{C.uniforms.time.value=u.viewport.clock.elapsedTime,this.ssp.render()}));const b=this.ssp.createPluginObject(e,E);return b.addEventListener("removed",(()=>{this.ssp.viewport.postUpdate.delete(e.id)})),b}createContactShadows(e){var{scale:t=10,frames:r=1/0,opacity:i=1,width:n=1,height:a=1,blur:o=1,darkness:s=1,far:u=10,resolution:l=512}=e,c=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(e,["scale","frames","opacity","width","height","blur","darkness","far","resolution"]);const{viewport:{renderer:p,scene:h},THREE:d}=this.ssp;n*=Array.isArray(t)?t[0]:t||1,a*=Array.isArray(t)?t[1]:t||1;const A=new d.Group,g=new d.OrthographicCamera(-n/2,n/2,a/2,-a/2,0,u);g.rotation.x=Math.PI/2,A.add(g);const f=new d.WebGLRenderTarget(l,l),y=new d.WebGLRenderTarget(l,l);y.texture.generateMipmaps=f.texture.generateMipmaps=!1;const m=new d.PlaneGeometry(n,a).rotateX(Math.PI/2),v=new d.MeshBasicMaterial({map:f.texture,opacity:i,transparent:!0,depthWrite:!1}),x=new d.Mesh(m,v);x.renderOrder=1,x.scale.y=-1,A.add(x);const w=new d.Mesh(m);w.visible=!1,A.add(w);const C=new d.MeshDepthMaterial;C.userData.darkness={value:s},C.onBeforeCompile=function(e){e.uniforms.darkness=C.userData.darkness,e.fragmentShader=`\n          uniform float darkness;\n          ${e.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );","gl_FragColor = vec4( vec3( 0.0 ), ( 1.0 - fragCoordZ ) * darkness );")}\n        `},C.depthTest=!1,C.depthWrite=!1;const E=new d.ShaderMaterial(L);E.depthTest=!1;const b=new d.ShaderMaterial(U);function B(e){w.visible=!0,w.material=E,E.uniforms.tDiffuse.value=f.texture,E.uniforms.h.value=1*e/256,p.setRenderTarget(y),p.render(w,g),w.material=b,b.uniforms.tDiffuse.value=y.texture,b.uniforms.v.value=1*e/256,p.setRenderTarget(f),p.render(w,g),w.visible=!1}b.depthTest=!1;let D=0;const M=()=>{if(D>r)return;D++;const e=h.background;h.background=null,h.overrideMaterial=C;const t=p.getClearAlpha();p.setClearAlpha(0),p.setRenderTarget(f),p.render(h,g),h.overrideMaterial=null,B(o),B(.4*o),p.setRenderTarget(null),p.setClearAlpha(t),h.background=e};this.ssp.signals.beforeRender.add(M);const I=this.ssp.createPluginObject(c,A);return I.addEventListener("removed",(()=>{this.ssp.signals.beforeRender.remove(M)})),I}openWeather(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{imgUrl:t=this.weatherPresetImgs.rain,count:r=500,range:i=100,size:n=1,opacity:a=.9,color:o=16777215,velocityX:s=[-.02,.02],velocityY:u=[.4,.8]}=e;this._weatherId&&this.closeWeather();const{THREE:l,viewport:{renderer:c,container:p},utils:h}=this.ssp,d=new Float32Array(3*r),A=Array.from({length:r}).fill({x:0,y:0}),g=new l.BufferGeometry;for(let e=0;e<r;e++)d[3*e]=l.MathUtils.randFloatSpread(i),d[3*e+1]=l.MathUtils.randFloatSpread(i),d[3*e+2]=l.MathUtils.randFloatSpread(i),A[e].x=l.MathUtils.randFloat(...s),A[e].y=l.MathUtils.randFloat(...u);const f=new l.BufferAttribute(d,3);f.setUsage(l.DynamicDrawUsage),g.setAttribute("position",f);const y=(new l.TextureLoader).load(t);y.encoding=c.outputEncoding;const m=new l.PointsMaterial({color:o,size:n,opacity:a,map:y,transparent:!0}),v=new l.Points(g,m),x=new l.Scene,w=new l.PerspectiveCamera(45,p.offsetWidth/p.offsetHeight,.1,1e3);w.position.set(0,0,i/2),x.add(v);this._weatherId=`weather_${h.randomString()}`,this.ssp.viewport.postRender.set(this._weatherId,(()=>{A.forEach(((e,t)=>{d[3*t]-=e.x,d[3*t+1]-=e.y,(d[3*t]<=-i/2||d[3*t]>=i/2)&&(A[t].x*=-1),d[3*t+1]<=-i/2&&(d[3*t+1]=i/2)})),f.needsUpdate=!0,c.render(x,w),this.ssp.render()})),this.ssp.render()}closeWeather(){this._weatherId&&(this.ssp.viewport.postRender.delete(this._weatherId),this._weatherId="",this.ssp.render())}removeEffect(e){return console.warn(" removeObjectById "),this.ssp.removeObjectById(e)}createParticleCluster(e){const t=new ve(e);return this.ssp.addObject(t),t}}export{ue as ClusterGeometry,fe as ClusterType,ve as ParticleCluster,me as ParticleClusterGeometry,ae as ParticleClusterShape,Ae as createHeatParticleClusterData,ge as createHeatParticleClusterDataArr,oe as createPointParticleClusterData,se as createPointParticleClusterDataArr,xe as default,ie as densityGradient_Default,$ as getRandomVector_Circle,ee as getRandomVector_CircleAnnular,te as getRandomVector_CircleCylinder,re as getRandomVector_CircleCylinderAnnular,Z as getRandomVector_Square,X as getRandomVector_SquareAnnular,_ as getRandomVector_SquareCylinder,q as getRandomVector_SquareCylinderAnnular,ne as valueGradient_Default,de as valuesAccumulate_Default};
